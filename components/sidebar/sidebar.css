@layer components {
    /* Provider container */
    [data-lux="sidebar.provider"] {
        @apply relative flex min-h-screen w-full overflow-hidden;
    }

    /* Sidebar container - Mobile first approach */
    [data-lux="sidebar"] {
        /* Mobile: wider sidebar, fixed positioning for overlay */
        @apply fixed inset-y-0 z-40 flex w-64 flex-col bg-sidebar border-r;
        /* Desktop: normal width, relative positioning */
        @apply md:relative md:w-64 md:z-auto;
    }

    /* Add transition only when initialized */
    [data-lux="sidebar.provider"][data-initialized="true"] [data-lux="sidebar"] {
        @apply transition-all duration-300 ease-in-out;
    }

    /* Inner content wrapper that maintains width */
    [data-lux="sidebar"] > * {
        @apply w-64 md:w-64;
    }

    /* Fixed positioning mode */
    [data-lux="sidebar"][data-fixed="true"] {
        @apply fixed inset-y-0 z-30;
    }

    [data-lux="sidebar"][data-fixed="true"][data-side="left"] {
        @apply left-0;
    }

    [data-lux="sidebar"][data-fixed="true"][data-side="right"] {
        @apply right-0;
    }

    /* Position variants */
    [data-lux="sidebar"][data-side="left"] {
        @apply left-0 order-first;
    }

    [data-lux="sidebar"][data-side="right"] {
        @apply right-0 order-last border-r-0 border-l;
    }

    /* Mobile: Non-fixed mode behaves like fixed (overlay) */
    [data-lux="sidebar"]:not([data-fixed="true"]) {
        @apply md:absolute md:inset-y-0;
    }

    /* Open/closed states for non-fixed mode on desktop */
    [data-lux="sidebar"][data-open="false"]:not([data-fixed="true"]) {
        @apply -translate-x-full md:translate-x-0 md:w-0 md:overflow-hidden md:border-r-0;
    }

    [data-lux="sidebar"][data-side="right"][data-open="false"]:not([data-fixed="true"]) {
        @apply translate-x-full md:translate-x-0;
    }

    [data-lux="sidebar"][data-open="true"]:not([data-fixed="true"]) {
        @apply translate-x-0 md:w-64;
    }

    /* Fixed mode open/closed states */
    [data-lux="sidebar"][data-fixed="true"][data-open="false"] {
        @apply -translate-x-full;
    }

    [data-lux="sidebar"][data-fixed="true"][data-side="right"][data-open="false"] {
        @apply translate-x-full;
    }

    [data-lux="sidebar"][data-fixed="true"][data-open="true"] {
        @apply translate-x-0;
    }

    /* Header */
    [data-lux="sidebar.header"] {
        @apply flex flex-col gap-2 p-4;
    }

    /* Content */
    [data-lux="sidebar.content"] {
        @apply flex-1 overflow-y-auto p-4;
    }

    /* Fixed mode: ensure content scrolls properly */
    [data-lux="sidebar"][data-fixed="true"] [data-lux="sidebar.content"] {
        @apply max-h-[calc(100vh-theme(spacing.32))];
    }

    /* Footer */
    [data-lux="sidebar.footer"] {
        @apply border-t p-4;
    }

    /* Group */
    [data-lux="sidebar.group"] {
        @apply space-y-2;
    }

    [data-lux="sidebar.group"] + [data-lux="sidebar.group"] {
        @apply mt-6;
    }

    /* Group title */
    [data-lux="sidebar.group-title"] {
        @apply mb-2 px-2 text-xs font-semibold uppercase tracking-wider text-muted-foreground;
    }

    /* Main content area (when sidebar is present) */
    [data-lux="sidebar.provider"] > *:not([data-lux="sidebar"]) {
        @apply flex-1 min-w-0;
    }

    /* Backdrop overlay - only visible on mobile */
    [data-lux="sidebar.provider"][data-open="true"]::before {
        content: "";
        @apply fixed inset-0 z-20 bg-black/50 md:hidden;
    }
}

/* Body classes for fixed sidebar mode */
body.sidebar-transition {
    @apply transition-all duration-300 ease-in-out;
}

/* Body padding only on desktop - mobile gets no padding */
body.sidebar-fixed.sidebar-open-left {
    @apply pl-0 md:pl-64;
}

body.sidebar-fixed.sidebar-closed-left {
    @apply pl-0;
}

body.sidebar-fixed.sidebar-open-right {
    @apply pr-0 md:pr-64;
}

body.sidebar-fixed.sidebar-closed-right {
    @apply pr-0;
}