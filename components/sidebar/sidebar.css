@layer components {
    /* Provider container */
    [data-lux="sidebar.provider"] {
        @apply relative flex min-h-screen w-full overflow-hidden;
    }

    /* ===== NON-FIXED MODE ===== */
    /* Sidebar container - placed within a container, no special mobile version */
    [data-lux="sidebar"][data-fixed="false"] {
        @apply relative flex flex-col bg-sidebar border-r;
        @apply transition-all duration-300 ease-in-out;
    }

    /* Non-fixed: Open state - full width */
    [data-lux="sidebar"][data-open="true"][data-fixed="false"] {
        @apply w-64 opacity-100;
    }

    /* Non-fixed: Closed state - zero width to give space to content */
    [data-lux="sidebar"][data-open="false"][data-fixed="false"] {
        @apply w-0 overflow-hidden border-r-0 opacity-0;
    }

    /* Inner content wrapper maintains consistent width */
    [data-lux="sidebar"][data-fixed="false"] > * {
        @apply w-64;
    }

    /* Position variants for non-fixed */
    [data-lux="sidebar"][data-fixed="false"][data-side="left"] {
        @apply order-first;
    }

    [data-lux="sidebar"][data-fixed="false"][data-side="right"] {
        @apply order-last border-r-0 border-l;
    }

    /* Non-fixed right side closed state */
    [data-lux="sidebar"][data-side="right"][data-open="false"][data-fixed="false"] {
        @apply border-l-0;
    }

    /* ===== FIXED MODE ===== */
    /* Fixed sidebar - positioned fixed, overlays content */
    [data-lux="sidebar"][data-fixed="true"] {
        @apply fixed inset-y-0 z-40 flex flex-col bg-sidebar border-r;
        @apply transition-transform duration-300 ease-in-out;
    }

    /* Fixed: Side positioning */
    [data-lux="sidebar"][data-fixed="true"][data-side="left"] {
        @apply left-0;
    }

    [data-lux="sidebar"][data-fixed="true"][data-side="right"] {
        @apply right-0 border-r-0 border-l;
    }

    /* Fixed: Open state - translate to visible */
    [data-lux="sidebar"][data-fixed="true"][data-open="true"] {
        @apply translate-x-0 w-64;
    }

    /* Fixed: Closed state - translate off-screen */
    [data-lux="sidebar"][data-fixed="true"][data-open="false"] {
        @apply w-64;
    }

    [data-lux="sidebar"][data-fixed="true"][data-open="false"][data-side="left"] {
        @apply -translate-x-full;
    }

    [data-lux="sidebar"][data-fixed="true"][data-open="false"][data-side="right"] {
        @apply translate-x-full;
    }

    /* Inner content wrapper for fixed mode */
    [data-lux="sidebar"][data-fixed="true"] > * {
        @apply w-64;
    }

    /* ===== SIDEBAR COMPONENTS ===== */
    /* Header */
    [data-lux="sidebar.header"] {
        @apply flex flex-col gap-2 p-4;
    }

    /* Content */
    [data-lux="sidebar.content"] {
        @apply flex-1 overflow-y-auto p-4;
    }

    /* Fixed mode: ensure content scrolls properly */
    [data-lux="sidebar"][data-fixed="true"] [data-lux="sidebar.content"] {
        @apply max-h-[calc(100vh-theme(spacing.32))];
    }

    /* Footer */
    [data-lux="sidebar.footer"] {
        @apply border-t p-4;
    }

    /* Group */
    [data-lux="sidebar.group"] {
        @apply flex flex-col gap-1;
    }

    [data-lux="sidebar.group"] + [data-lux="sidebar.group"] {
        @apply mt-6;
    }

    /* Group title */
    [data-lux="sidebar.group-title"] {
        @apply mb-2 px-2 text-xs font-semibold uppercase tracking-wider text-muted-foreground;
    }

    /* Main content area (when sidebar is in non-fixed mode) */
    [data-lux="sidebar.provider"] > *:not([data-lux="sidebar"]) {
        @apply flex-1 min-w-0;
    }

    /* ===== MOBILE BACKDROP (FIXED MODE ONLY) ===== */
    /* Backdrop overlay - only for fixed mode on mobile */
    [data-lux="sidebar.provider"][data-fixed="true"][data-open="true"]::before {
        content: "";
        @apply fixed inset-0 z-30 bg-black/50 md:hidden;
    }
}

/* ===== BODY OFFSETS FOR FIXED MODE ===== */
/* Body classes for fixed sidebar mode - adds margin to offset content */
body.sidebar-transition {
    @apply transition-all duration-300 ease-in-out;
}

/* Fixed left sidebar open - add left margin on desktop only */
body.sidebar-open-left {
    @apply ml-0 md:ml-64;
}


/* Fixed right sidebar open - add right margin on desktop only */
body.sidebar-open-right {
    @apply mr-0 md:mr-64;
}
